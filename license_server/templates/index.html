<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vietnamese OCR Tool - License Store</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            color: white;
            padding: 40px 20px;
        }

        header h1 {
            font-size: 3em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        header p {
            font-size: 1.3em;
            opacity: 0.9;
        }

        .pricing-section {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
            margin: 40px 0;
        }

        .pricing-card {
            background: white;
            border-radius: 20px;
            padding: 40px 30px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
            transition: transform 0.3s, box-shadow 0.3s;
            text-align: center;
        }

        .pricing-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }

        .pricing-card.popular {
            border: 3px solid #667eea;
            position: relative;
        }

        .popular-badge {
            position: absolute;
            top: -15px;
            left: 50%;
            transform: translateX(-50%);
            background: #667eea;
            color: white;
            padding: 8px 20px;
            border-radius: 20px;
            font-weight: bold;
            font-size: 0.9em;
        }

        .plan-name {
            font-size: 2em;
            color: #333;
            margin-bottom: 20px;
            font-weight: bold;
        }

        .plan-price {
            font-size: 3em;
            color: #667eea;
            margin-bottom: 10px;
            font-weight: bold;
        }

        .plan-duration {
            color: #666;
            font-size: 1.1em;
            margin-bottom: 30px;
        }

        .features {
            list-style: none;
            margin: 30px 0;
            text-align: left;
        }

        .features li {
            padding: 12px 0;
            border-bottom: 1px solid #f0f0f0;
            color: #555;
            display: flex;
            align-items: center;
        }

        .features li:before {
            content: "‚úì";
            color: #667eea;
            font-weight: bold;
            margin-right: 10px;
            font-size: 1.3em;
        }

        .buy-button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 40px;
            border-radius: 30px;
            font-size: 1.2em;
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            width: 100%;
        }

        .buy-button:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 20px rgba(102, 126, 234, 0.5);
        }

        .buy-button:active {
            transform: scale(0.98);
        }

        .features-highlight {
            background: #f8f9ff;
            padding: 40px;
            border-radius: 20px;
            margin: 40px 0;
            color: #333;
        }

        .features-highlight h2 {
            text-align: center;
            font-size: 2em;
            margin-bottom: 30px;
            color: #667eea;
        }

        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }

        .feature-item {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .feature-item h3 {
            color: #667eea;
            margin-bottom: 10px;
            font-size: 1.3em;
        }

        .contact-section {
            background: white;
            padding: 40px;
            border-radius: 20px;
            margin: 40px 0;
            text-align: center;
        }

        .contact-section h2 {
            color: #667eea;
            font-size: 2em;
            margin-bottom: 20px;
        }

        .contact-info {
            font-size: 1.2em;
            color: #555;
        }

        .contact-info a {
            color: #667eea;
            text-decoration: none;
            font-weight: bold;
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.7);
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background: white;
            padding: 40px;
            border-radius: 20px;
            max-width: 500px;
            width: 90%;
            text-align: center;
            animation: slideIn 0.3s;
        }

        @keyframes slideIn {
            from {
                transform: translateY(-50px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        .modal-content h2 {
            color: #667eea;
            margin-bottom: 20px;
        }

        .modal-content p {
            color: #666;
            margin-bottom: 20px;
            line-height: 1.6;
        }

        .close-button {
            background: #667eea;
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 1em;
        }

        footer {
            text-align: center;
            color: white;
            padding: 40px 20px;
            opacity: 0.8;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üîç Vietnamese OCR Tool</h1>
            <p>C√¥ng c·ª• nh·∫≠n d·∫°ng ch·ªØ ti·∫øng Vi·ªát t·ªët nh·∫•t - Nhanh, Ch√≠nh x√°c, Ti·ªán l·ª£i</p>
        </header>

        <div class="pricing-section" style="display: flex; justify-content: center; gap: 30px; flex-wrap: wrap;">
            <!-- TEST Plan - For Testing -->
            <div class="pricing-card" style="max-width: 400px; border: 2px solid #f59e0b;">
                <div class="popular-badge" style="background: #f59e0b;">üß™ TEST - CH·ªà ƒê·ªÇ TH·∫§M</div>
                <div class="plan-name">G√≥i Test</div>
                <div class="plan-price">2,000‚Ç´</div>
                <div class="plan-duration">Th·ª≠ nghi·ªám 1 ng√†y</div>
                <ul class="features">
                    <li>‚úÖ Test ch·ª©c nƒÉng ƒë·∫ßy ƒë·ªß</li>
                    <li>‚úÖ OCR ti·∫øng Vi·ªát ch√≠nh x√°c</li>
                    <li>‚úÖ T·ª± ƒë·ªông nh·∫≠n license qua email</li>
                    <li>‚úÖ S·ª≠ d·ª•ng 1 ng√†y</li>
                    <li>‚ö†Ô∏è Ch·ªâ ƒë·ªÉ test h·ªá th·ªëng</li>
                </ul>
                <button class="buy-button" style="background: #f59e0b;" onclick="showPurchaseModal('test', '2,000‚Ç´')">
                    üß™ Test Ngay - 2,000‚Ç´
                </button>
            </div>

            <!-- Lifetime Plan -->
            <div class="pricing-card popular" style="max-width: 450px;">
                <div class="popular-badge">‚≠ê GI√Å ∆ØU ƒê√ÉI ƒê·∫∂C BI·ªÜT</div>
                <div class="plan-name">K√≠ch Ho·∫°t Tr·ªçn ƒê·ªùi</div>
                <div class="plan-price">100,000‚Ç´</div>
                <div class="plan-duration">M·ªôt l·∫ßn - S·ª≠ d·ª•ng m√£i m√£i</div>
                <ul class="features">
                    <li>‚úÖ S·ª≠ d·ª•ng tr·ªçn ƒë·ªùi kh√¥ng gi·ªõi h·∫°n</li>
                    <li>‚úÖ OCR ti·∫øng Vi·ªát ch√≠nh x√°c cao (98%)</li>
                    <li>‚úÖ Ch·ªçn v√πng m√†n h√¨nh linh ho·∫°t</li>
                    <li>‚úÖ T·ª± ƒë·ªông copy v√†o clipboard</li>
                    <li>‚úÖ H·ªó tr·ª£ ph√≠m t·∫Øt t√πy ch·ªânh</li>
                    <li>‚úÖ C·∫≠p nh·∫≠t mi·ªÖn ph√≠ m√£i m√£i</li>
                    <li>‚úÖ H·ªó tr·ª£ k·ªπ thu·∫≠t 24/7</li>
                    <li>‚úÖ K√≠ch ho·∫°t t·ª± ƒë·ªông sau khi thanh to√°n</li>
                </ul>
                <button class="buy-button" onclick="showPurchaseModal('lifetime', '100,000‚Ç´')">
                    üöÄ Mua Ngay - Ch·ªâ 100,000‚Ç´
                </button>
            </div>
        </div>

        <div class="features-highlight">
            <h2>üöÄ T√≠nh nƒÉng n·ªïi b·∫≠t</h2>
            <div class="feature-grid">
                <div class="feature-item">
                    <h3>‚ö° Si√™u Nhanh</h3>
                    <p>Nh·∫≠n d·∫°ng ch·ªØ ch·ªâ trong v√†i gi√¢y v·ªõi c√¥ng ngh·ªá AI ti√™n ti·∫øn</p>
                </div>
                <div class="feature-item">
                    <h3>üéØ Ch√≠nh X√°c Cao</h3>
                    <p>ƒê·ªô ch√≠nh x√°c l√™n ƒë·∫øn 98% v·ªõi ch·ªØ ti·∫øng Vi·ªát c√≥ d·∫•u</p>
                </div>
                <div class="feature-item">
                    <h3>üñ±Ô∏è D·ªÖ S·ª≠ D·ª•ng</h3>
                    <p>Ch·ªâ c·∫ßn nh·∫•n ph√≠m t·∫Øt, ch·ªçn v√πng v√† xong!</p>
                </div>
                <div class="feature-item">
                    <h3>üìã Auto Copy</h3>
                    <p>T·ª± ƒë·ªông sao ch√©p vƒÉn b·∫£n v√†o clipboard ƒë·ªÉ d√°n ngay</p>
                </div>
                <div class="feature-item">
                    <h3>‚öôÔ∏è T√πy Ch·ªânh</h3>
                    <p>ƒê·∫∑t ph√≠m t·∫Øt theo √Ω th√≠ch, ph√π h·ª£p v·ªõi workflow</p>
                </div>
                <div class="feature-item">
                    <h3>üîí B·∫£o M·∫≠t</h3>
                    <p>X·ª≠ l√Ω offline, kh√¥ng g·ª≠i d·ªØ li·ªáu l√™n server</p>
                </div>
            </div>
        </div>

        <div class="contact-section">
            <h2>üìû Li√™n H·ªá & H·ªó Tr·ª£</h2>
            <div class="contact-info">
                <p>Email: <a href="mailto:support@ocrvietnamese.com">support@ocrvietnamese.com</a></p>
                <p>Hotline: <a href="tel:0123456789">0123 456 789</a></p>
                <p>Gi·ªù l√†m vi·ªác: 8:00 - 22:00 h√†ng ng√†y</p>
            </div>
        </div>
    </div>

    <!-- Purchase Modal -->
    <div id="purchaseModal" class="modal">
        <div class="modal-content" style="max-width: 600px;">
            <h2 style="color: #667eea; margin-bottom: 20px;">üè¶ H∆∞·ªõng D·∫´n Thanh To√°n</h2>
            <p id="modalText" style="font-size: 1.1em; color: #333; margin-bottom: 20px;"></p>
            
            <!-- Email Input -->
            <div class="payment-input" style="margin-bottom: 25px;">
                <label style="display: block; text-align: left; margin-bottom: 8px; color: #555; font-weight: bold;">
                    üìß Email nh·∫≠n License Key:
                </label>
                <input type="email" id="customerEmail" placeholder="Nh·∫≠p email c·ªßa b·∫°n" required
                       style="width: 100%; padding: 14px; border: 2px solid #667eea; border-radius: 10px; font-size: 16px;">
            </div>
            
            <!-- Bank Transfer Info -->
            <div id="bankInfo" style="display: none; background: #f8f9ff; padding: 20px; border-radius: 12px; margin-bottom: 20px; border: 2px solid #667eea;">
                <h3 style="color: #667eea; margin-bottom: 15px; text-align: center;">üí≥ Th√¥ng Tin Chuy·ªÉn Kho·∫£n</h3>
                
                <!-- VietQR Code -->
                <div id="qrCodeContainer" style="text-align: center; margin-bottom: 20px;">
                    <!-- QR Code will be generated here by QRCode.js -->
                    <div id="qrCodeDiv" style="display: inline-block; padding: 15px; background: white; border-radius: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.15);"></div>
                    <p style="margin-top: 10px; color: #667eea; font-weight: bold; font-size: 1.1em;">üì± Qu√©t m√£ QR ƒë·ªÉ thanh to√°n nhanh</p>
                </div>
                
                <div style="text-align: center; margin-bottom: 15px; padding: 10px; background: #e8f5e9; border-radius: 8px;">
                    <p style="margin: 0; color: #2e7d32; font-weight: bold;">‚ú® M·ªü app ng√¢n h√†ng ‚Üí Qu√©t QR ‚Üí X√°c nh·∫≠n thanh to√°n!</p>
                    <p style="margin: 5px 0 0 0; font-size: 0.9em; color: #555;">N·ªôi dung CK ƒë√£ ƒë∆∞·ª£c ƒëi·ªÅn s·∫µn trong QR!</p>
                </div>
                
                <div style="text-align: center; margin-bottom: 15px;">
                    <p style="color: #999; font-size: 0.9em;">‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ ho·∫∑c chuy·ªÉn kho·∫£n th·ªß c√¥ng ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ</p>
                </div>
                
                <div style="background: white; padding: 15px; border-radius: 8px; margin-bottom: 15px;">
                    <div style="display: grid; gap: 10px; text-align: left;">
                        <div><strong>üè¶ Ng√¢n h√†ng:</strong> <span id="bankName">ƒêang t·∫£i...</span></div>
                        <div><strong>üì± S·ªë t√†i kho·∫£n:</strong> <span id="accountNumber" style="font-size: 1.2em; color: #667eea; font-weight: bold;">ƒêang t·∫£i...</span></div>
                        <div><strong>üë§ Ch·ªß t√†i kho·∫£n:</strong> <span id="accountName">ƒêang t·∫£i...</span></div>
                        <div><strong>üí∞ S·ªë ti·ªÅn:</strong> <span id="transferAmount" style="font-size: 1.3em; color: #e74c3c; font-weight: bold;">100,000‚Ç´</span></div>
                        <div><strong>‚úâÔ∏è N·ªôi dung CK:</strong> <span id="transferContent" style="font-size: 1.1em; color: #667eea; font-weight: bold;">EMAIL</span></div>
                    </div>
                </div>
                
                <div style="background: #fff3cd; padding: 12px; border-radius: 8px; border-left: 4px solid #ffc107;">
                    <p style="margin: 0; color: #856404; font-size: 0.95em;">
                        ‚ö†Ô∏è <strong>L∆ØU √ù:</strong> Vui l√≤ng ghi <strong>CH√çNH X√ÅC email c·ªßa b·∫°n</strong> v√†o n·ªôi dung chuy·ªÉn kho·∫£n ƒë·ªÉ h·ªá th·ªëng t·ª± ƒë·ªông g·ª≠i License Key!
                    </p>
                </div>
                
                <div style="margin-top: 15px; padding: 12px; background: #d4edda; border-radius: 8px; border-left: 4px solid #28a745;">
                    <p style="margin: 0; color: #155724; font-size: 0.95em;">
                        ‚úÖ <strong>Sau khi chuy·ªÉn kho·∫£n:</strong> License Key s·∫Ω ƒë∆∞·ª£c g·ª≠i t·ª± ƒë·ªông v·ªÅ email trong v√≤ng <strong>1-2 ph√∫t</strong>!
                    </p>
                </div>
            </div>
            
            <!-- Create Order Button -->
            <button id="createOrderBtn" class="buy-button" onclick="createOrder()" style="margin-bottom: 15px;">
                üöÄ T·∫°o ƒê∆°n H√†ng & Xem Th√¥ng Tin CK
            </button>
            
            <!-- Copy Email Button (hidden by default) -->
            <button id="copyEmailBtn" style="display: none; background: #28a745; color: white; padding: 12px; border: none; border-radius: 10px; font-size: 1em; font-weight: bold; cursor: pointer; width: 100%; margin-bottom: 10px;" onclick="copyEmail()">
                üìã Copy Email ƒë·ªÉ ƒëi·ªÅn v√†o n·ªôi dung CK
            </button>
            
            <div style="margin-top: 15px; padding-top: 15px; border-top: 1px solid #e0e0e0;">
                <p style="font-size: 0.9em; color: #666;"><strong>C·∫ßn h·ªó tr·ª£?</strong></p>
                <p style="font-size: 0.9em;">üìß <a href="mailto:support@ocrvietnamese.com">support@ocrvietnamese.com</a> | üì± 0123 456 789</p>
            </div>
            
            <button class="close-button" onclick="closeModal()" style="margin-top: 15px; background: #95a5a6;">ƒê√≥ng</button>
        </div>
    </div>

    <footer>
        <p>&copy; 2025 Vietnamese OCR Tool. All rights reserved.</p>
        <p>Made with ‚ù§Ô∏è in Vietnam</p>
    </footer>

    <script>
        let currentOrderId = null;
        let userEmail = '';

        function showPurchaseModal(plan, price) {
            const modal = document.getElementById('purchaseModal');
            const modalText = document.getElementById('modalText');
            
            // Hi·ªÉn th·ªã t√™n g√≥i v√† gi√° t∆∞∆°ng ·ª©ng
            let planName = plan === 'test' ? 'G√≥i Test' : 'G√≥i K√≠ch Ho·∫°t Tr·ªçn ƒê·ªùi';
            modalText.innerHTML = `<strong>${planName}</strong><br>Gi√°: <strong style="color: #e74c3c; font-size: 1.3em;">${price}</strong>`;
            
            // L∆∞u plan type ƒë·ªÉ d√πng khi t·∫°o order
            window.currentPlanType = plan;
            window.currentPlanPrice = price;
            
            modal.style.display = 'flex';
            
            // Reset state
            document.getElementById('bankInfo').style.display = 'none';
            document.getElementById('qrCodeContainer').style.display = 'none';
            document.getElementById('createOrderBtn').style.display = 'block';
            document.getElementById('copyEmailBtn').style.display = 'none';
            document.getElementById('customerEmail').value = '';
            currentOrderId = null;
        }

        async function createOrder() {
            const email = document.getElementById('customerEmail').value.trim();
            
            if (!email) {
                alert('‚ö†Ô∏è Vui l√≤ng nh·∫≠p email!');
                return;
            }
            
            if (!email.includes('@') || !email.includes('.')) {
                alert('‚ö†Ô∏è Email kh√¥ng h·ª£p l·ªá!');
                return;
            }
            
            userEmail = email;
            
            // Show loading
            const btn = document.getElementById('createOrderBtn');
            btn.disabled = true;
            btn.innerText = '‚è≥ ƒêang t·∫°o ƒë∆°n h√†ng...';
            
            try {
                // L·∫•y plan type v√† price t·ª´ window
                const planType = window.currentPlanType || 'lifetime';
                const priceString = window.currentPlanPrice || '100,000‚Ç´';
                
                // Chuy·ªÉn ƒë·ªïi price string th√†nh s·ªë (b·ªè d·∫•u ph·∫©y v√† ‚Ç´)
                const amount = parseInt(priceString.replace(/[,‚Ç´]/g, ''));
                
                const response = await fetch('/api/payment/create-order', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        customer_email: email,
                        plan_type: planType,
                        amount: amount
                    })
                });
                
                const data = await response.json();
                
                // üî• DEBUG: Log TO√ÄN B·ªò response
                console.log('========== FULL RESPONSE DATA ==========');
                console.log('Response Object:', data);
                console.log('All Keys:', Object.keys(data));
                console.log('========================================');
                
                if (data.success) {
                    currentOrderId = data.order_id;
                    
                    // Log th√¥ng tin chi ti·∫øt
                    console.log('‚úÖ PayOS Payment Created');
                    console.log('Order ID:', data.order_id);
                    console.log('Payment Link ID:', data.payment_link_id);
                    console.log('Amount:', data.amount);
                    
                    // üî• DEBUG QR CODE field
                    console.log('--- QR CODE DEBUG ---');
                    console.log('data.qr_code exists:', 'qr_code' in data);
                    console.log('data.qr_code value:', data.qr_code);
                    console.log('data.qr_code type:', typeof data.qr_code);
                    if (data.qr_code) {
                        console.log('data.qr_code length:', data.qr_code.length);
                        console.log('data.qr_code first 50 chars:', data.qr_code.substring(0, 50));
                    }
                    
                    // üî• DEBUG CHECKOUT URL field
                    console.log('--- CHECKOUT URL DEBUG ---');
                    console.log('data.checkout_url exists:', 'checkout_url' in data);
                    console.log('data.checkout_url value:', data.checkout_url);
                    console.log('data.checkout_url type:', typeof data.checkout_url);
                    console.log('---------------------');
                    
                    // ‚úÖ Redirect to PayOS checkout URL
                    if (data.checkout_url) {
                        console.log('‚Üí Redirecting to PayOS checkout page:', data.checkout_url);
                        
                        alert('‚úÖ ƒê∆°n h√†ng ƒë√£ ƒë∆∞·ª£c t·∫°o!\n\nüîÑ ƒêang chuy·ªÉn t·ªõi trang thanh to√°n PayOS...\n\nüì± Sau khi thanh to√°n, b·∫°n s·∫Ω nh·∫≠n ƒë∆∞·ª£c License Key ngay!');
                        
                        // Redirect to PayOS checkout page
                        setTimeout(() => {
                            window.location.href = data.checkout_url;
                        }, 1500);
                        
                    } else {
                        // Kh√¥ng c√≥ checkout URL = L·ªói
                        console.error('‚ùå No checkout URL!');
                        alert('‚ùå L·ªói t·∫°o thanh to√°n!\n\nKh√¥ng nh·∫≠n ƒë∆∞·ª£c link thanh to√°n. Vui l√≤ng th·ª≠ l·∫°i.');
                        btn.disabled = false;
                        btn.innerText = 'T·∫°o ƒê∆°n H√†ng';
                    }
                } else {
                    alert('‚ùå L·ªói: ' + (data.error || 'Kh√¥ng th·ªÉ t·∫°o ƒë∆°n h√†ng'));
                    btn.disabled = false;
                    btn.innerText = 'üöÄ T·∫°o ƒê∆°n H√†ng & Xem Th√¥ng Tin CK';
                }
            } catch (error) {
                alert('‚ùå L·ªói k·∫øt n·ªëi: ' + error.message);
                btn.disabled = false;
                btn.innerText = 'üöÄ T·∫°o ƒê∆°n H√†ng & Xem Th√¥ng Tin CK';
            }
        }

        function copyEmail() {
            if (!userEmail) {
                alert('‚ö†Ô∏è Kh√¥ng c√≥ email ƒë·ªÉ copy!');
                return;
            }
            
            // Copy to clipboard
            navigator.clipboard.writeText(userEmail).then(() => {
                const btn = document.getElementById('copyEmailBtn');
                const originalText = btn.innerText;
                btn.innerText = '‚úÖ ƒê√£ copy email!';
                btn.style.background = '#28a745';
                
                setTimeout(() => {
                    btn.innerText = originalText;
                    btn.style.background = '#28a745';
                }, 2000);
                
                alert('‚úÖ ƒê√£ copy email: ' + userEmail + '\n\nH√£y d√°n v√†o n·ªôi dung chuy·ªÉn kho·∫£n!');
            }).catch(err => {
                alert('‚ùå Kh√¥ng th·ªÉ copy: ' + err);
            });
        }

        function closeModal() {
            document.getElementById('purchaseModal').style.display = 'none';
        }

        // Close modal when clicking outside
        window.onclick = function(event) {
            const modal = document.getElementById('purchaseModal');
            if (event.target === modal) {
                closeModal();
            }
        }
    </script>
    
    <!-- QRCode.js Library for generating QR codes from text -->
    <script src="https://cdn.jsdelivr.net/npm/qrcodejs@1.0.0/qrcode.min.js"></script>
</body>
</html>

